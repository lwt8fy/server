package net.jeeshop.web.action.manage.comment;import net.jeeshop.core.BaseAction;import net.jeeshop.core.ManageContainer;import net.jeeshop.core.system.bean.User;import net.jeeshop.services.manage.comment.CommentService;import net.jeeshop.services.manage.comment.bean.Comment;import net.jeeshop.services.manage.company.bean.Company;import org.apache.commons.lang.StringUtils;public class CommentAction extends BaseAction<Comment> {	private static final long serialVersionUID = 1L;	private CommentService commentService;	public CommentService getCommentService() {		return commentService;	}	@Override	protected void selectListAfter() {		pager.setPagerUrl("comment!selectList.action");	}	public void setCommentService(CommentService commentService) {		this.commentService = commentService;	}	@Override	public Comment getE() {		return this.e;	}	@Override	public void prepare() throws Exception {		if (this.e == null) {			this.e = new Comment();		}		super.initPageSelect();	}	@Override	public void insertAfter(Comment e) {		e.clear();	}		/**	 * 设置选中的评论显示	 * @return	 * @throws Exception	 */	public String updateStatusY() throws Exception{		if(getIds()!=null && getIds().length>0){			commentService.updateStatus(getIds(),net.jeeshop.services.common.Comment.comment_status_y);		}		return selectList();	}	/**	 * 设置选中的评论不显示	 * @return	 * @throws Exception	 */	public String updateStatusN() throws Exception{		if(getIds()!=null && getIds().length>0){			commentService.updateStatus(getIds(),net.jeeshop.services.common.Comment.comment_status_n);		}		return selectList();	}		/**	 * 回复用户评论	 * @return	 * @throws Exception	 */	public String updateReply() throws Exception{		if(StringUtils.isBlank(e.getReply()) || StringUtils.isBlank(e.getId())){			throw new NullPointerException(ManageContainer.OrderAction_param_null);		}//		String update = getRequest().getParameter("update");//y:修改回复//		if(update.equals("y")){//			Comment ee = commentService.selectById(e.getId());//			if(ee==null){//				throw new NullPointerException("查询不到评论信息!");//			}//			//			ee.setReply(e.getReply());//		}				Comment c = new Comment();		c.setId(e.getId());		c.setReply(e.getReply());		commentService.update(c);		//		return selectList();		return super.selectAllList;	}		@Override	public String selectList() throws Exception {		User user = (User)getSession().getAttribute(ManageContainer.manage_session_user_info);		if(user==null){			throw new NullPointerException("您没有权限!");		}		if(!user.getRid().equals("1")){		Company com = (Company) getSession().getAttribute(ManageContainer.manage_session_company_info);		if(com==null){			throw new NullPointerException("您没有权限!");		}		e.setCompID(com.getId());		}		return super.selectList();	}		@Override	protected void setParamWhenInitQuery() {		super.setParamWhenInitQuery();		String selectCommentFromIndex = getRequest().getParameter("selectCommentFromIndex");		if(StringUtils.isNotBlank(selectCommentFromIndex)){			e.setSelectCommentFromIndex(Boolean.valueOf(selectCommentFromIndex));		}	}}